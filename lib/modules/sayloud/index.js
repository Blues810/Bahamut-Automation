var l=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var v=t=>l(t,"__esModule",{value:!0});var S=(t,e)=>{for(var o in e)l(t,o,{get:e[o],enumerable:!0})},k=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of L(e))!b.call(t,r)&&(o||r!=="default")&&l(t,r,{get:()=>e[r],enumerable:!(n=P(e,r))||n.enumerable});return t};var T=(t=>(e,o)=>t&&t.get(e)||(o=k(v({}),e,1),t&&t.set(e,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);var C={};S(C,{default:()=>q});var h=class{parameters=[];run({page:e,outputs:o,params:n,logger:r}){throw new Error("Module not implemented.")}},$=h;var g=new $;g.parameters=[{name:"sayloud",required:!0,example:[{to:"All Users",text:"Hello World!"}]}];g.run=async({page:t,outputs:e,params:o,logger:n})=>{let r=(...s)=>n.log("[95m[\u52C7\u8005\u5927\u8072\u8AAA][m",...s),m=(...s)=>n.warn("[95m[\u52C7\u8005\u5927\u8072\u8AAA][m",...s);if(!e.login||!e.login.success)throw new Error("\u4F7F\u7528\u8005\u672A\u767B\u5165\uFF0C\u7121\u6CD5\u767C\u4F48\u52C7\u8005\u5927\u8072\u8AAA");let{sayloud:a}=o;if(a.length<1)return{success:!1};await t.goto("https://home.gamer.com.tw/homeindex.php");let d=a[Math.floor(Math.random()*a.length)],w=f(d.to),x=f(d.text),i=await t.evaluate(async({to:s,text:I})=>{let c=await fetch("https://home.gamer.com.tw/ajax/sayloud1.php?re=0",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:null}).then(u=>u.text());if(c.includes("\u76EE\u524D\u4ECD\u6709\u5927\u8072\u8AAA\u5728\u653E\u9001"))return 2;let p=document.createElement("div");p.innerHTML=c;let M=p.querySelector("[name=token]").value;return await fetch("https://home.gamer.com.tw/ajax/sayloud2.php",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:`idType=2&uid=&nick=${s}&token=${M}&content=${encodeURIComponent(I)}`}).then(u=>u.text())},{to:w,text:x});return i===2?(m("\u76EE\u524D\u4ECD\u6709\u5927\u8072\u8AAA\u5728\u653E\u9001"),{success:!1,reason:"\u76EE\u524D\u4ECD\u6709\u5927\u8072\u8AAA\u5728\u653E\u9001",report:"\u52C7\u8005\u5927\u8072\u8AAA\uFF1A \u767C\u9001\u5931\u6557 "}):(r("\u653E\u9001\u6210\u529F \u6642\u9593\uFF1A"+i),{success:!0,time:i,report:"\u52C7\u8005\u5927\u8072\u8AAA\uFF1A \u767C\u9001\u6210\u529F "+i})};function f(t){let e=E(),o=[[/\$time\$/g,"$year$/$month$/$day$ $hour$:$minute$:$second$"],[/\$year\$/g,e[0]],[/\$month\$/g,e[1]],[/\$day\$/g,e[2]],[/\$hour\$/g,e[3]],[/\$minute\$/g,e[4]],[/\$second\$/g,e[5]]];for(let n=0;n<o.length;n++)t=t.replace(o[n][0],o[n][1]);return t}function E(){let t=new Date().toLocaleString("en",{timeZone:"Asia/Taipei"}).split(", "),[e,o,n]=t[0].split("/"),[r,m,a]=t[1].match(/\d{1,2}/g);return+r==12&&t[1].toLowerCase().includes("am")&&(r=String(+r-12)),+r<12&&t[1].toLowerCase().includes("pm")&&(r=String(+r+12)),[n,e,o,r,m,a]}var q=g;module.exports=T(C);0&&(module.exports={});
