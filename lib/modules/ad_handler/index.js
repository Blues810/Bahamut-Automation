var i=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var h=e=>i(e,"__esModule",{value:!0});var v=(e,t)=>{for(var o in t)i(e,o,{get:t[o],enumerable:!0})},P=(e,t,o,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of w(t))!y.call(e,r)&&(o||r!=="default")&&i(e,r,{get:()=>t[r],enumerable:!(a=p(t,r))||a.enumerable});return e};var b=(e=>(t,o)=>e&&e.get(t)||(o=P(h({}),t,1),e&&e.set(t,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);var k={};v(k,{default:()=>f});var u=class{parameters=[];run({page:t,outputs:o,params:a,logger:r}){throw new Error("Module not implemented.")}},l=u;var g=new l,n=(...e)=>{},d=(...e)=>{};g.run=async function({logger:e}){return n=(...t)=>e.log("[95m[AD Handler][m",...t),d=(...t)=>e.error("[95m[AD Handler][m",...t),n("\u5DF2\u8A2D\u5B9A Google AD \u8655\u7406\u7A0B\u5F0F"),I};async function I({ad_frame:e,timeout:t=60,log:o=n,error:a=d}){o("Google AD \u8655\u7406\u7A0B\u5F0F: Start");let r=await Promise.race([T(t*1e3,"timed out"),(async()=>{try{if(await e.waitForTimeout(1e3),await e.$(".rewardDialogueWrapper:not([style*=none]) .rewardResumebutton")&&await e.click(".rewardDialogueWrapper:not([style*=none]) .rewardResumebutton"),await Promise.race([e.waitForSelector(".videoAdUiSkipContainer.html5-stop-propagation > button",{timeout:35e3}),M(e),m(e)]).catch(()=>{}),await e.waitForTimeout(1e3),await e.$(".videoAdUiSkipContainer.html5-stop-propagation > button"))await e.click(".videoAdUiSkipContainer.html5-stop-propagation > button");else if(await e.$("div#close_button_icon"))await e.click("div#close_button_icon");else if(await e.$("#google-rewarded-video > img:nth-child(4)"))await e.click("#google-rewarded-video > img:nth-child(4)");else if(!await m(e))throw new Error("\u767C\u73FE\u672A\u77E5\u985E\u578B\u7684\u5EE3\u544A");await e.waitForTimeout(2e3)}catch(c){a(c)}})()]);o(r==="timed out"?"Google AD \u8655\u7406\u7A0B\u5F0F: Timed Out":"Google AD \u8655\u7406\u7A0B\u5F0F: Finished")}async function m(e){let t=await e.waitForSelector("video");return await t.evaluate(o=>o.ended)?!0:t.evaluate(o=>new Promise(a=>o.addEventListener("ended",()=>a(!0))))}function M(e){return new Promise(async t=>{try{let o=await e.$("#count_down");if(o){let a=+(await o.evaluate(r=>r.innerText)).replace(/[^0-9]/g,"");setTimeout(t,(a+1)*1e3)}else setTimeout(t,35*1e3)}catch{setTimeout(t,35*1e3)}})}function T(e=1e3,t){return new Promise(o=>setTimeout(()=>o(t),e))}var f=g;module.exports=b(k);0&&(module.exports={});
