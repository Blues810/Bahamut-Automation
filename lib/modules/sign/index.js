var F=Object.create;var s=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var f=a=>s(a,"__esModule",{value:!0});var A=(a,t)=>{for(var o in t)s(a,o,{get:t[o],enumerable:!0})},y=(a,t,o,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of T(t))!v.call(a,e)&&(o||e!=="default")&&s(a,e,{get:()=>t[e],enumerable:!(i=M(t,e))||i.enumerable});return a},L=(a,t)=>y(f(s(a!=null?F(k(a)):{},"default",!t&&a&&a.__esModule?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a),S=(a=>(t,o)=>a&&a.get(t)||(o=y(f({}),t,1),a&&a.set(t,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);var j={};A(j,{default:()=>E});var h=L(require("countapi-js"));var w=class{parameters=[];run({page:t,outputs:o,params:i,logger:e}){throw new Error("Module not implemented.")}};var c=new w;c.parameters=[{name:"sign_double_max_attempts",required:!1}];c.run=async({page:a,outputs:t,params:o,logger:i})=>{let e=(...r)=>i.log("\x1B[95m[\u7C3D\u5230]\x1B[m",...r),P=(...r)=>i.warn("\x1B[95m[\u7C3D\u5230]\x1B[m",...r),m=(...r)=>i.error("\x1B[95m[\u7C3D\u5230]\x1B[m",...r);if(!t.utils.logged_in())throw new Error("\u4F7F\u7528\u8005\u672A\u767B\u5165\uFF0C\u7121\u6CD5\u7C3D\u5230");e("\u958B\u59CB\u57F7\u884C"),await a.goto("https://www.gamer.com.tw/"),await a.waitForTimeout(2e3);let{days:x,finishedAd:u,signin:b}=await d(a),I=b;if(e(`\u5DF2\u9023\u7E8C\u7C3D\u5230\u5929\u6578: ${x}`),b?e("\u4ECA\u65E5\u5DF2\u7C3D\u5230 \x1B[92m\u2714\x1B[m"):(e("\u4ECA\u65E5\u5C1A\u672A\u7C3D\u5230 \x1B[91m\u2718\x1B[m"),e("\u6B63\u5728\u5617\u8A66\u7C3D\u5230"),await a.click("a#signin-btn").catch(m),await a.waitForTimeout(5e3),e("\u6210\u529F\u7C3D\u5230 \x1B[92m\u2714\x1B[m")),t.ad_handler){let r=+o.sign_double_max_attempts||3;for(let l=0;l<r;l++)try{if(e("\u6B63\u5728\u6AA2\u6E2C\u96D9\u500D\u7C3D\u5230\u734E\u52F5\u72C0\u614B"),await a.goto("https://www.gamer.com.tw/"),await a.waitForSelector("a#signin-btn"),await a.waitForTimeout(50),await a.click("a#signin-btn"),await a.waitForSelector("text=\u89C0\u770B\u5EE3\u544A\u9818\u53D6\u96D9\u500D\u5DF4\u5E63"),await a.waitForTimeout(50),u){e("\u5DF2\u7372\u5F97\u96D9\u500D\u7C3D\u5230\u734E\u52F5 \x1B[92m\u2714\x1B[m");break}else{if(e("\u5C1A\u672A\u7372\u5F97\u96D9\u500D\u7C3D\u5230\u734E\u52F5 \x1B[91m\u2718\x1B[m"),e("\u5617\u8A66\u89C0\u770B\u5EE3\u544A\u4EE5\u7372\u5F97\u96D9\u500D\u734E\u52F5\uFF0C\u53EF\u80FD\u9700\u8981\u591A\u9054 1 \u5206\u9418"),await a.click("text=\u89C0\u770B\u5EE3\u544A\u9818\u53D6\u96D9\u500D\u5DF4\u5E63"),await Promise.all([a.waitForResponse(/\gampad\/ads/),a.click("text=\u89C0\u770B\u5EE3\u544A\u9818\u53D6\u96D9\u500D\u5DF4\u5E63")]),await a.waitForTimeout(50),await a.$("text=\u5EE3\u544A\u80FD\u91CF\u88DC\u5145\u4E2D \u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002"))throw new Error("\u5EE3\u544A\u80FD\u91CF\u88DC\u5145\u4E2D\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66");await a.waitForSelector("button[type=submit]"),await a.waitForTimeout(100),await a.click("button[type=submit]"),await a.waitForTimeout(3e3),await a.waitForSelector("ins iframe");let _=await(await a.$("ins iframe")).contentFrame();if(await t.ad_handler({ad_frame:_}),u=(await d(a)).finishedAd,u){e("\u5DF2\u89C0\u770B\u96D9\u500D\u734E\u52F5\u5EE3\u544A \x1B[92m\u2714\x1B[m");break}throw new Error("\u89C0\u770B\u96D9\u500D\u734E\u52F5\u5EE3\u544A\u904E\u7A0B\u767C\u751F\u672A\u77E5\u932F\u8AA4")}}catch(g){m(g),m(`\u89C0\u770B\u96D9\u500D\u734E\u52F5\u5EE3\u544A\u904E\u7A0B\u767C\u751F\u932F\u8AA4\uFF0C\u5C07\u518D\u91CD\u8A66 ${r-l-1} \u6B21 \x1B[91m\u2718\x1B[m`)}}else P("\u96D9\u500D\u7C3D\u5230\u734E\u52F5\u9700\u4F7F\u7528 ad_handler \u6A21\u7D44");let n=await d(a);return e("\u57F7\u884C\u5B8C\u7562 \u2728"),!I&&n.signin&&h.default.update("Bahamut-Automation","sign",1),{signed:!!n.signin,doubled:!!n.finishedAd,days:n.days,report:$}};async function d(a){let{data:t}=await a.evaluate(async()=>{let o=new AbortController;return setTimeout(()=>o.abort(),3e4),(await fetch("https://www.gamer.com.tw/ajax/signin.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=2",signal:o.signal})).json()});return t}function $({days:a,signed:t,doubled:o}){let i=`# \u7C3D\u5230

`;return i+=`\u2728\u2728\u2728 \u5DF2\u9023\u7E8C\u7C3D\u5230 ${a} \u5929 \u2728\u2728\u2728
`,t?i+=`\u{1F7E2} \u4ECA\u65E5\u5DF2\u7C3D\u5230
`:i+=`\u274C \u4ECA\u65E5\u5C1A\u672A\u7C3D\u5230
`,o?i+=`\u{1F7E2} \u5DF2\u7372\u5F97\u96D9\u500D\u7C3D\u5230\u734E\u52F5
`:i+=`\u274C \u5C1A\u672A\u7372\u5F97\u96D9\u500D\u7C3D\u5230\u734E\u52F5
`,i+=`
`,i}var E=c;module.exports=S(j);0&&(module.exports={});
